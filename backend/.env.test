###> SYMFONY TEST ENVIRONMENT ###
APP_ENV=test
APP_SECRET=test_secret_not_for_production
APP_URL=http://localhost:8001
FRONTEND_URL=http://localhost:5173
LOG_LEVEL=error
XDEBUG_MODE=off
###< SYMFONY TEST ENVIRONMENT ###

###> DATABASE (TEST) ###
# Note: Symfony auto-appends "_test" to the database name when APP_ENV=test
DATABASE_WRITE_URL=mysql://synaplan_test:synaplan_test@db_test:3306/synaplan?serverVersion=11.8&charset=utf8mb4
DATABASE_READ_URL=mysql://synaplan_test:synaplan_test@db_test:3306/synaplan?serverVersion=11.8&charset=utf8mb4
###< DATABASE ###

###> REDIS (TEST) ###
REDIS_URL=redis://redis_test:6379
REDIS_CACHE_PREFIX=synaplan_test_cache
REDIS_SESSION_PREFIX=synaplan_test_session
###< REDIS ###

###> MESSENGER (TEST) ###
MESSENGER_TRANSPORT_DSN=redis://redis_test:6379/messages
###< MESSENGER ###

###> SECURITY & JWT (TEST) ###
JWT_SECRET_KEY=%kernel.project_dir%/config/jwt/private.pem
JWT_PUBLIC_KEY=%kernel.project_dir%/config/jwt/public.pem
JWT_PASSPHRASE=test_passphrase
JWT_TOKEN_TTL=86400
CORS_ALLOW_ORIGIN=^https?://.*$
###< SECURITY & JWT ###

###> EMAIL & MAILER (TEST) ###
MAILER_DSN=null://null
APP_SENDER_EMAIL=test@synaplan.local
APP_SENDER_NAME="Synaplan Test"

EMAIL_VERIFICATION_COOLDOWN_MINUTES=1
EMAIL_VERIFICATION_MAX_ATTEMPTS=10
EMAIL_VERIFICATION_CLEANUP_DAYS=1
###< EMAIL & MAILER ###

###> AI PROVIDERS (TEST) ###
ANTHROPIC_API_KEY=test-key
ANTHROPIC_BASE_URL=https://api.anthropic.com/v1
ANTHROPIC_DEFAULT_MODEL=claude-3-5-sonnet-20241022
ANTHROPIC_TIMEOUT=60
ANTHROPIC_MAX_RETRIES=3

OPENAI_API_KEY=test-key
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_DEFAULT_MODEL=gpt-4o
OPENAI_EMBEDDING_MODEL=text-embedding-3-small
OPENAI_IMAGE_MODEL=dall-e-3
OPENAI_TTS_MODEL=tts-1
OPENAI_STT_MODEL=whisper-1

OLLAMA_BASE_URL=http://ollama_test:11434
OLLAMA_DEFAULT_MODEL=llama3.2:3b
OLLAMA_EMBEDDING_MODEL=nomic-embed-text

AI_DEFAULT_PROVIDER=test
AI_FALLBACK_CHAIN=test
AI_FALLBACK_TIMEOUT=30
###< AI PROVIDERS ###

###> EXTERNAL SERVICES (TEST) ###
TIKA_BASE_URL=http://tika_test:9998
TIKA_URL=http://tika_test:9998
TIKA_TIMEOUT_MS=10000
TIKA_RETRIES=1
TIKA_RETRY_BACKOFF_MS=500
TIKA_MIN_LENGTH=10
TIKA_MIN_ENTROPY=1.0

# Whisper.cpp Audio Transcription (Test)
WHISPER_BINARY=/usr/local/bin/whisper
WHISPER_MODELS_PATH=/var/www/html/var/whisper
WHISPER_DEFAULT_MODEL=base
WHISPER_ENABLED=false
FFMPEG_BINARY=/usr/bin/ffmpeg

RASTERIZE_DPI=72
RASTERIZE_PAGE_CAP=5
RASTERIZE_TIMEOUT_MS=10000
###< EXTERNAL SERVICES ###

###> FILE STORAGE (TEST) ###
UPLOADS_DIR=/app/var/test_uploads
MAX_UPLOAD_SIZE=10M
###< FILE STORAGE ###

###> RATE LIMITING (TEST) ###
RATE_LIMIT_ENABLED=false
RATE_LIMIT_DEFAULT_LIMIT=1000
RATE_LIMIT_DEFAULT_WINDOW=60
###< RATE LIMITING ###

###> CIRCUIT BREAKER (TEST) ###
CIRCUIT_BREAKER_FAILURE_THRESHOLD=10
CIRCUIT_BREAKER_SUCCESS_THRESHOLD=2
CIRCUIT_BREAKER_TIMEOUT=30
CIRCUIT_BREAKER_HALF_OPEN_MAX_CALLS=5
###< CIRCUIT BREAKER ###

###> FEATURE FLAGS (TEST) ###
FEATURE_SYMFONY_API_ENABLED=true
FEATURE_WIDGET_SYMFONY_ENABLED=true
FEATURE_RATE_LIMITING_STRICT=false
###< FEATURE FLAGS ###

###> MONITORING (TEST) ###
SENTRY_DSN=
PROMETHEUS_ENABLED=false
###< MONITORING ###
