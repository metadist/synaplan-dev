# Copy this file to .env.local and fill in your values
# .env.local is not committed to git and should contain all your configuration
# For testing, see .env.test (which IS committed)

###> SYMFONY CORE ###
APP_ENV=dev
APP_SECRET=changeme_generate_with_bin_console_secrets_generate_keys
APP_URL=http://localhost:8000
FRONTEND_URL=http://localhost:5173
LOG_LEVEL=info
XDEBUG_MODE=off
###< SYMFONY CORE ###

###> DATABASE ###
DATABASE_WRITE_URL=mysql://synaplan_user:synaplan_password@db:3306/synaplan?serverVersion=11.8&charset=utf8mb4
DATABASE_READ_URL=mysql://synaplan_user:synaplan_password@db:3306/synaplan?serverVersion=11.8&charset=utf8mb4
###< DATABASE ###

###> REDIS ###
REDIS_URL=redis://redis:6379
REDIS_CACHE_PREFIX=synaplan_cache
REDIS_SESSION_PREFIX=synaplan_session
###< REDIS ###

###> MESSENGER ###
MESSENGER_TRANSPORT_DSN=redis://redis:6379/messages
###< MESSENGER ###

###> SECURITY & JWT ###
JWT_SECRET_KEY=%kernel.project_dir%/config/jwt/private.pem
JWT_PUBLIC_KEY=%kernel.project_dir%/config/jwt/public.pem
JWT_PASSPHRASE=your_passphrase_here
JWT_TOKEN_TTL=86400
CORS_ALLOW_ORIGIN=^https?://(localhost|127\.0\.0\.1)(:[0-9]+)?$
###< SECURITY & JWT ###

###> EMAIL & MAILER ###
# Dev: MailHog (http://localhost:8025)
MAILER_DSN=smtp://mailhog:1025
# Production: Put real SMTP in .env.local
# MAILER_DSN=smtp://user:pass@smtp.gmail.com:587

APP_SENDER_EMAIL=noreply@synaplan.com
APP_SENDER_NAME="Synaplan"

EMAIL_VERIFICATION_COOLDOWN_MINUTES=2
EMAIL_VERIFICATION_MAX_ATTEMPTS=5
EMAIL_VERIFICATION_CLEANUP_DAYS=30
###< EMAIL & MAILER ###

###> AI PROVIDERS ###
# Put API keys in .env.local (not committed)
ANTHROPIC_API_KEY=
ANTHROPIC_BASE_URL=https://api.anthropic.com/v1
ANTHROPIC_DEFAULT_MODEL=claude-3-5-sonnet-20241022
ANTHROPIC_TIMEOUT=60
ANTHROPIC_MAX_RETRIES=3

OPENAI_API_KEY=
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_DEFAULT_MODEL=gpt-4o
OPENAI_EMBEDDING_MODEL=text-embedding-3-small
OPENAI_IMAGE_MODEL=dall-e-3
OPENAI_TTS_MODEL=tts-1
OPENAI_STT_MODEL=whisper-1

OLLAMA_BASE_URL=http://ollama:11434
OLLAMA_DEFAULT_MODEL=llama3.2:3b
OLLAMA_EMBEDDING_MODEL=nomic-embed-text

AI_DEFAULT_PROVIDER=ollama
AI_FALLBACK_CHAIN=anthropic,openai,ollama
AI_FALLBACK_TIMEOUT=60
###< AI PROVIDERS ###

###> EXTERNAL SERVICES ###
TIKA_BASE_URL=http://tika:9998
TIKA_URL=http://tika:9998
TIKA_TIMEOUT_MS=30000
TIKA_RETRIES=2
TIKA_RETRY_BACKOFF_MS=1000
TIKA_MIN_LENGTH=50
TIKA_MIN_ENTROPY=2.0

WHISPER_MODEL_PATH=/app/models/whisper

RASTERIZE_DPI=150
RASTERIZE_PAGE_CAP=10
RASTERIZE_TIMEOUT_MS=30000
###< EXTERNAL SERVICES ###

###> FILE STORAGE ###
UPLOADS_DIR=/app/var/uploads
MAX_UPLOAD_SIZE=50M
###< FILE STORAGE ###

###> RATE LIMITING ###
RATE_LIMIT_ENABLED=true
RATE_LIMIT_DEFAULT_LIMIT=100
RATE_LIMIT_DEFAULT_WINDOW=60
###< RATE LIMITING ###

###> CIRCUIT BREAKER ###
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
CIRCUIT_BREAKER_SUCCESS_THRESHOLD=2
CIRCUIT_BREAKER_TIMEOUT=60
CIRCUIT_BREAKER_HALF_OPEN_MAX_CALLS=3
###< CIRCUIT BREAKER ###

###> FEATURE FLAGS ###
FEATURE_SYMFONY_API_ENABLED=true
FEATURE_WIDGET_SYMFONY_ENABLED=false
FEATURE_RATE_LIMITING_STRICT=true
###< FEATURE FLAGS ###

###> MONITORING ###
SENTRY_DSN=
PROMETHEUS_ENABLED=false
###< MONITORING ###
